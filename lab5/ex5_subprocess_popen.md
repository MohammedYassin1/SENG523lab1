The original yaml file contained only one rule so I was checking for both 'Popen' and 'run' under the same rule. 'Patterns:' defines a list of patterns that need to be matched for the rule. 'Pattern-either' defines a list of patterns to OR match so only one pattern needs to match. '$CMD' defines that it is matching a variable as the first argument. 'shell=True' defines that it only matches if it is running the command in the shell. The '...' after defines it should match if any other arguments are passed. The 'Pattern-not' defines patterns that should be excluded from the rule. 'Pattern-either' is used again so it will exclude any match of the defined patterns. For the excluded patterns the first argument is what we are looking at. '"..."' defines a string literal. '["...", "..."]' will exclude lists of only string literals. '["..."]' defines a list that contains only string literals. We only look for string literals or a list of string literals because that is what the expected arguments for 'popen' and 'run' are.